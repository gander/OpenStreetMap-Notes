import{r as e,e as t,v as o,x as a,h as n,y as s,z as l,A as r,B as i,C as c,f as u,D as d,w as g,F as v,E as m,n as p,o as f,G as h}from"./vendor-4X7pGT-Q.js";import{t as y,p as _}from"./maps-uONSGgcc.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const E=(e,t)=>{const o=e.__vccOpts||e;for(const[a,n]of t)o[a]=n;return o},L={class:"map-container"},b={class:"map-controls"},C=["disabled","title"];const w={class:"crosshair"};const S={class:"event-logger"},k={class:"event-logger__header"},P={class:"event-logger__controls"},x={class:"event-logger__content",ref:"logContent"},M={class:"event-logger__item-header"},$={class:"event-logger__item-type"},F={class:"event-logger__item-time"},G={class:"event-logger__item-message"},A={key:0,class:"event-logger__empty"};const I={class:"app"},T={class:"header"},z={class:"header__controls"},O={class:"main"},j={class:"map-section"};const D=h(E({name:"App",components:{MapContainer:E({name:"MapContainer",emits:["coordinates-changed","location-found","location-error","map-event"],setup(t,{emit:o}){const a=e(null),n=e(!1),s=e(null),l=e(null),r=e([0,0]),i=e(2),c=e("EPSG:3857"),{getCurrentPosition:u}=function(){const t=e("geolocation"in navigator),o=e(!1),a=e(null);return{isSupported:t,isLoading:o,error:a,getCurrentPosition:(e={})=>new Promise((n,s)=>{if(!t.value){const e=new Error("Geolocation is not supported by this browser");return e.code=0,void s(e)}o.value=!0,a.value=null;const l={enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4,...e};navigator.geolocation.getCurrentPosition(e=>{o.value=!1,n(e)},e=>{o.value=!1,a.value=e,s(e)},l)}),watchPosition:(e,o={})=>{if(!t.value){const e=new Error("Geolocation is not supported by this browser");return e.code=0,a.value=e,null}const n={enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4,...o};return navigator.geolocation.watchPosition(t=>{a.value=null,e(t)},t=>{a.value=t,e(null,t)},n)},clearWatch:e=>{e&&t.value&&navigator.geolocation.clearWatch(e)}}}();return r.value=y([-.09,51.505],"EPSG:4326","EPSG:3857"),i.value=13,{view:a,center:r,zoom:i,projection:c,userLocation:l,isLocating:n,locationStatus:s,handleMapMove:e=>{if(a.value){const e=a.value.getCenter(),[t,n]=y(e,"EPSG:3857","EPSG:4326");o("coordinates-changed",{lat:n,lng:t,accuracy:null}),o("map-event",{type:"map_moved",message:`Map moved to ${n.toFixed(6)}, ${t.toFixed(6)}`})}},handleMapClick:e=>{const[t,a]=y(e.coordinate,"EPSG:3857","EPSG:4326");o("map-event",{type:"map_clicked",message:`Map clicked at ${a.toFixed(6)}, ${t.toFixed(6)}`}),o("coordinates-changed",{lat:a,lng:t,accuracy:null})},locateUser:async()=>{if(!n.value){n.value=!0,s.value={type:"info",message:"Locating..."};try{const e=await u({enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}),{latitude:t,longitude:a,accuracy:n}=e.coords,c=y([a,t],"EPSG:4326","EPSG:3857");r.value=c,i.value=16,l.value=c,s.value={type:"success",message:`Location found (Â±${Math.round(n)}m accuracy)`},o("location-found",{lat:t,lng:a,accuracy:n}),o("coordinates-changed",{lat:t,lng:a,accuracy:n}),o("map-event",{type:"gps_location",message:`GPS location: ${t.toFixed(6)}, ${a.toFixed(6)}`}),setTimeout(()=>{s.value=null},3e3)}catch(e){let t="Location access denied or unavailable";switch(e.code){case 1:t="Location access denied by user";break;case 2:t="Location unavailable";break;case 3:t="Location request timed out";break;default:t=e.message||"Unknown location error"}s.value={type:"error",message:t},o("location-error",{code:e.code,message:t}),setTimeout(()=>{s.value=null},5e3)}finally{n.value=!1}}},getStatusIcon:e=>{switch(e){case"success":return"fas fa-check-circle";case"error":return"fas fa-exclamation-circle";default:return"fas fa-info-circle"}}}}},[["render",function(e,g,v,m,p,f){const h=c("ol-view"),y=c("ol-source-osm"),_=c("ol-tile-layer"),E=c("ol-geom-point"),w=c("ol-style-fill"),S=c("ol-style-stroke"),k=c("ol-style-circle"),P=c("ol-style"),x=c("ol-feature"),M=c("ol-source-vector"),$=c("ol-vector-layer"),F=c("ol-map");return u(),t("div",L,[o(F,{loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,style:{height:"100%"},onMoveend:m.handleMapMove,onClick:m.handleMapClick},{default:s(()=>[o(h,{ref:"view",center:m.center,zoom:m.zoom,projection:m.projection},null,8,["center","zoom","projection"]),o(_,null,{default:s(()=>[o(y)]),_:1}),m.userLocation?(u(),d($,{key:0},{default:s(()=>[o(M,null,{default:s(()=>[o(x,null,{default:s(()=>[o(E,{coordinates:m.userLocation},null,8,["coordinates"]),o(P,null,{default:s(()=>[o(k,{radius:8},{default:s(()=>[o(w,{color:"blue"}),o(S,{color:"white",width:2})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):n("",!0)]),_:1},8,["onMoveend","onClick"]),a("div",b,[a("button",{onClick:g[0]||(g[0]=(...e)=>m.locateUser&&m.locateUser(...e)),class:"btn btn--primary btn--round",disabled:m.isLocating,title:m.isLocating?"Locating...":"Find my location"},[a("i",{class:l(m.isLocating?"fas fa-spinner fa-spin":"fas fa-location-arrow")},null,2)],8,C)]),m.locationStatus?(u(),t("div",{key:0,class:l(["location-status",`location-status--${m.locationStatus.type}`])},[a("i",{class:l(m.getStatusIcon(m.locationStatus.type))},null,2),r(" "+i(m.locationStatus.message),1)],2)):n("",!0)])}]]),Crosshair:E({name:"Crosshair"},[["render",function(e,o,n,s,l,r){return u(),t("div",w,o[0]||(o[0]=[a("div",{class:"crosshair__horizontal"},null,-1),a("div",{class:"crosshair__vertical"},null,-1),a("div",{class:"crosshair__center"},null,-1)]))}],["__scopeId","data-v-c2b118c8"]]),EventLogger:E({name:"EventLogger",props:{events:{type:Array,required:!0}},emits:["close"],setup(t){const o=e(null);return g(()=>t.events.length,async()=>{await p(),o.value&&(o.value.scrollTop=o.value.scrollHeight)}),{logContent:o,getEventIcon:e=>({gps:"fas fa-location-arrow",coordinates:"fas fa-crosshairs",map:"fas fa-map",ui:"fas fa-mouse-pointer",system:"fas fa-cog",error:"fas fa-exclamation-triangle",map_initialized:"fas fa-map",map_moved:"fas fa-arrows-alt",map_zoomed:"fas fa-search",map_clicked:"fas fa-mouse-pointer"}[e]||"fas fa-circle"),formatTime:e=>new Date(e).toLocaleTimeString()}}},[["render",function(e,o,s,c,d,g){return u(),t("div",S,[a("div",k,[o[2]||(o[2]=a("h3",{class:"event-logger__title"},[a("i",{class:"fas fa-list"}),r(" Event Log ")],-1)),a("div",P,[a("button",{onClick:o[0]||(o[0]=t=>e.$emit("close")),class:"btn btn--small btn--secondary"},o[1]||(o[1]=[a("i",{class:"fas fa-times"},null,-1)]))])]),a("div",x,[(u(!0),t(v,null,m(s.events,e=>(u(),t("div",{key:e.id,class:l(["event-logger__item",`event-logger__item--${e.type}`])},[a("div",M,[a("span",$,[a("i",{class:l(c.getEventIcon(e.type))},null,2),r(" "+i(e.type.toUpperCase()),1)]),a("span",F,i(c.formatTime(e.timestamp)),1)]),a("div",G,i(e.message),1)],2))),128)),0===s.events.length?(u(),t("div",A,o[3]||(o[3]=[a("i",{class:"fas fa-inbox"},null,-1),a("p",null,"No events logged yet",-1)]))):n("",!0)],512)])}],["__scopeId","data-v-91cebd05"]])},setup(){const t=e(!1),o=e({lat:null,lng:null,accuracy:null}),{events:a,logEvent:n}=function(){const t=e([]),o=(e,o,a={})=>{const n={id:Date.now()+Math.random().toString(36).substr(2,9),type:e,message:o,timestamp:Date.now(),...a};t.value.push(n),t.value.length>100&&(t.value=t.value.slice(-100)),console.log(`[${e.toUpperCase()}] ${o}`,a)};return{events:t,logEvent:o,clearEvents:()=>{t.value=[],o("system","Event log cleared")},getEventsByType:e=>t.value.filter(t=>t.type===e),getEventsInTimeRange:(e,o)=>t.value.filter(t=>t.timestamp>=e&&t.timestamp<=o),exportEvents:()=>{const e={exportDate:(new Date).toISOString(),totalEvents:t.value.length,events:t.value};return JSON.stringify(e,null,2)}}}();return f(()=>{n("system","Application initialized")}),{showEventLogger:t,currentCoordinates:o,events:a,toggleEventLogger:()=>{t.value=!t.value,n("ui","Event logger "+(t.value?"opened":"closed"))},handleCoordinatesChanged:e=>{o.value=e,n("coordinates",`Crosshair positioned at ${e.lat.toFixed(6)}, ${e.lng.toFixed(6)}`)},handleLocationFound:e=>{n("gps",`GPS location found: ${e.lat.toFixed(6)}, ${e.lng.toFixed(6)} (accuracy: ${e.accuracy}m)`)},handleLocationError:e=>{n("error",`GPS error: ${e.message}`)},logEvent:n}}},[["render",function(e,s,i,g,v,m){const p=c("MapContainer"),f=c("Crosshair"),h=c("EventLogger");return u(),t("div",I,[a("header",T,[s[3]||(s[3]=a("h1",{class:"header__title"},[a("i",{class:"fas fa-crosshairs"}),r(" OSM Notes v0.1.1 ")],-1)),a("div",z,[a("button",{onClick:s[0]||(s[0]=(...e)=>g.toggleEventLogger&&g.toggleEventLogger(...e)),class:l(["btn btn--secondary",{"btn--active":g.showEventLogger}])},s[2]||(s[2]=[a("i",{class:"fas fa-list"},null,-1),a("span",{class:"btn__text"},"Events",-1)]),2)])]),a("main",O,[a("div",j,[o(p,{onCoordinatesChanged:g.handleCoordinatesChanged,onLocationFound:g.handleLocationFound,onLocationError:g.handleLocationError,onMapEvent:g.logEvent},null,8,["onCoordinatesChanged","onLocationFound","onLocationError","onMapEvent"]),o(f)]),g.showEventLogger?(u(),d(h,{key:0,events:g.events,onClose:s[1]||(s[1]=e=>g.showEventLogger=!1)},null,8,["events"])):n("",!0)])])}]]));D.use(_),D.mount("#app");

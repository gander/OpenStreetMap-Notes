import{r as e,e as o,v as a,x as t,h as n,y as l,z as s,A as i,B as c,C as r,f as u,D as d,F as g,E as v,w as p,n as f,c as m,a as h,G as b,H as y,k as C,I as S,o as _,J as E}from"./vendor-ByBhMQkW.js";import{t as k,p as w}from"./maps-B63TE_RA.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&o(e)}).observe(document,{childList:!0,subtree:!0})}function o(e){if(e.ep)return;e.ep=!0;const o=function(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?o.credentials="include":"anonymous"===e.crossOrigin?o.credentials="omit":o.credentials="same-origin",o}(e);fetch(e.href,o)}}();const P=(e,o)=>{const a=e.__vccOpts||e;for(const[t,n]of o)a[t]=n;return a},L={class:"map-container"},x={class:"map-controls"},N=["disabled","title"];const A=P({name:"MapContainer",props:{notes:{type:Array,default:()=>[]}},emits:["coordinates-changed","location-found","location-error","map-event","pin-clicked"],setup(o,{emit:a}){const t=e(null),n=e(!1),l=e(null),s=e(null),i=e([0,0]),c=e(2),r=e("EPSG:3857"),{getCurrentPosition:u}=function(){const o=e("geolocation"in navigator),a=e(!1),t=e(null);return{isSupported:o,isLoading:a,error:t,getCurrentPosition:(e={})=>new Promise((n,l)=>{if(!o.value){const e=new Error("Geolocation is not supported by this browser");return e.code=0,void l(e)}a.value=!0,t.value=null;const s={enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4,...e};navigator.geolocation.getCurrentPosition(e=>{a.value=!1,n(e)},e=>{a.value=!1,t.value=e,l(e)},s)}),watchPosition:(e,a={})=>{if(!o.value){const e=new Error("Geolocation is not supported by this browser");return e.code=0,t.value=e,null}const n={enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4,...a};return navigator.geolocation.watchPosition(o=>{t.value=null,e(o)},o=>{t.value=o,e(null,o)},n)},clearWatch:e=>{e&&o.value&&navigator.geolocation.clearWatch(e)}}}();return i.value=k([-.09,51.505],"EPSG:4326","EPSG:3857"),c.value=13,{view:t,center:i,zoom:c,projection:r,userLocation:s,isLocating:n,locationStatus:l,handleMapMove:e=>{if(t.value){const e=t.value.getCenter(),[o,n]=k(e,"EPSG:3857","EPSG:4326");a("coordinates-changed",{lat:n,lng:o,accuracy:null}),a("map-event",{type:"map_moved",message:`Map moved to ${n.toFixed(6)}, ${o.toFixed(6)}`})}},handleMapClick:e=>{const[o,t]=k(e.coordinate,"EPSG:3857","EPSG:4326");a("map-event",{type:"map_clicked",message:`Map clicked at ${t.toFixed(6)}, ${o.toFixed(6)}`}),a("coordinates-changed",{lat:t,lng:o,accuracy:null})},handlePinClick:e=>{a("pin-clicked",e),a("map-event",{type:"pin_clicked",message:`Clicked ${e.type} note pin`})},locateUser:async()=>{if(!n.value){n.value=!0,l.value={type:"info",message:"Locating..."};try{const e=await u({enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}),{latitude:o,longitude:t,accuracy:n}=e.coords,r=k([t,o],"EPSG:4326","EPSG:3857");i.value=r,c.value=16,s.value=r,l.value={type:"success",message:`Location found (Â±${Math.round(n)}m accuracy)`},a("location-found",{lat:o,lng:t,accuracy:n}),a("coordinates-changed",{lat:o,lng:t,accuracy:n}),a("map-event",{type:"gps_location",message:`GPS location: ${o.toFixed(6)}, ${t.toFixed(6)}`}),setTimeout(()=>{l.value=null},3e3)}catch(e){let o="Location access denied or unavailable";switch(e.code){case 1:o="Location access denied by user";break;case 2:o="Location unavailable";break;case 3:o="Location request timed out";break;default:o=e.message||"Unknown location error"}l.value={type:"error",message:o},a("location-error",{code:e.code,message:o}),setTimeout(()=>{l.value=null},5e3)}finally{n.value=!1}}},getStatusIcon:e=>{switch(e){case"success":return"fas fa-check-circle";case"error":return"fas fa-exclamation-circle";default:return"fas fa-info-circle"}},transform:k}}},[["render",function(e,p,f,m,h,b){const y=r("ol-view"),C=r("ol-source-osm"),S=r("ol-tile-layer"),_=r("ol-geom-point"),E=r("ol-style-fill"),k=r("ol-style-stroke"),w=r("ol-style-circle"),P=r("ol-style"),A=r("ol-feature"),I=r("ol-source-vector"),T=r("ol-vector-layer"),U=r("ol-style-text"),$=r("ol-map");return u(),o("div",L,[a($,{loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,style:{height:"100%"},onMoveend:m.handleMapMove,onClick:m.handleMapClick},{default:l(()=>[a(y,{ref:"view",center:m.center,zoom:m.zoom,projection:m.projection},null,8,["center","zoom","projection"]),a(S,null,{default:l(()=>[a(C)]),_:1}),m.userLocation?(u(),d(T,{key:0},{default:l(()=>[a(I,null,{default:l(()=>[a(A,null,{default:l(()=>[a(_,{coordinates:m.userLocation},null,8,["coordinates"]),a(P,null,{default:l(()=>[a(w,{radius:8},{default:l(()=>[a(E,{color:"blue"}),a(k,{color:"white",width:2})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):n("",!0),a(T,null,{default:l(()=>[a(I,null,{default:l(()=>[(u(!0),o(g,null,v(f.notes,e=>(u(),d(A,{key:e.id,onClick:o=>m.handlePinClick(e)},{default:l(()=>[a(_,{coordinates:m.transform([e.coordinates.lng,e.coordinates.lat],"EPSG:4326","EPSG:3857")},null,8,["coordinates"]),a(P,null,{default:l(()=>[a(w,{radius:12},{default:l(()=>[a(E,{color:"local"===e.type?"#28a745":"#dc3545"},null,8,["color"]),a(k,{color:"white",width:2})]),_:2},1024),a(U,{text:"ðŸ“",font:"16px sans-serif"})]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["onMoveend","onClick"]),t("div",x,[t("button",{onClick:p[0]||(p[0]=(...e)=>m.locateUser&&m.locateUser(...e)),class:"btn btn--primary btn--round",disabled:m.isLocating,title:m.isLocating?"Locating...":"Find my location"},[t("i",{class:s(m.isLocating?"fas fa-spinner fa-spin":"fas fa-location-arrow")},null,2)],8,N)]),m.locationStatus?(u(),o("div",{key:0,class:s(["location-status",`location-status--${m.locationStatus.type}`])},[t("i",{class:s(m.getStatusIcon(m.locationStatus.type))},null,2),i(" "+c(m.locationStatus.message),1)],2)):n("",!0)])}]]),I={class:"crosshair"};const T=P({name:"Crosshair"},[["render",function(e,a,n,l,s,i){return u(),o("div",I,a[0]||(a[0]=[t("div",{class:"crosshair__horizontal"},null,-1),t("div",{class:"crosshair__vertical"},null,-1),t("div",{class:"crosshair__center"},null,-1)]))}],["__scopeId","data-v-c2b118c8"]]),U={class:"event-logger"},$={class:"event-logger__content",ref:"logContent"},F={class:"event-logger__item-header"},M={class:"event-logger__item-type"},O={class:"event-logger__item-time"},G={class:"event-logger__item-message"},D={key:0,class:"event-logger__empty"};const R=P({name:"EventLogger",props:{events:{type:Array,required:!0}},emits:["close"],setup(o){const a=e(null);return p(()=>o.events.length,async()=>{await f(),a.value&&(a.value.scrollTop=a.value.scrollHeight)}),{logContent:a,getEventIcon:e=>({gps:"fas fa-location-arrow",coordinates:"fas fa-crosshairs",map:"fas fa-map",ui:"fas fa-mouse-pointer",system:"fas fa-cog",error:"fas fa-exclamation-triangle",map_initialized:"fas fa-map",map_moved:"fas fa-arrows-alt",map_zoomed:"fas fa-search",map_clicked:"fas fa-mouse-pointer"}[e]||"fas fa-circle"),formatTime:e=>new Date(e).toLocaleTimeString()}}},[["render",function(e,a,l,r,d,p){return u(),o("div",U,[a[1]||(a[1]=t("div",{class:"event-logger__header"},[t("h3",{class:"event-logger__title"},[t("i",{class:"fas fa-list"}),i(" Event Log ")]),t("div",{class:"event-logger__controls"})],-1)),t("div",$,[(u(!0),o(g,null,v(l.events,e=>(u(),o("div",{key:e.id,class:s(["event-logger__item",`event-logger__item--${e.type}`])},[t("div",F,[t("span",M,[t("i",{class:s(r.getEventIcon(e.type))},null,2),i(" "+c(e.type.toUpperCase()),1)]),t("span",O,c(r.formatTime(e.timestamp)),1)]),t("div",G,c(e.message),1)],2))),128)),0===l.events.length?(u(),o("div",D,a[0]||(a[0]=[t("i",{class:"fas fa-inbox"},null,-1),t("p",null,"No events logged yet",-1)]))):n("",!0)],512)])}],["__scopeId","data-v-ab1234c2"]]),j={name:"NotePanel",props:{isVisible:{type:Boolean,default:!1},coordinates:{type:Object,required:!0}},emits:["close","save-note"],setup(o,{emit:a}){const t=e(""),n=e(null),l=e(null),s=e(null),i=e(!1),c=e(!1),r=e(0),u=e(null),d=e([]),g=e(null),v=m(()=>t.value.trim()||n.value||l.value),f=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});u.value=new MediaRecorder(e),d.value=[],u.value.ondataavailable=e=>{d.value.push(e.data)},u.value.onstop=()=>{const o=new Blob(d.value,{type:"audio/wav"});n.value=URL.createObjectURL(o),e.getTracks().forEach(e=>e.stop())},u.value.start(),i.value=!0,r.value=0,g.value=setInterval(()=>{r.value+=1},1e3)}catch(e){console.error("Error accessing microphone:",e),alert("Cannot access microphone. Please check permissions.")}},b=()=>{u.value&&i.value&&(u.value.stop(),i.value=!1,g.value&&(clearInterval(g.value),g.value=null))},y=()=>{t.value="",n.value=null,l.value=null,r.value=0,s.value&&(s.value.value="")};return h(()=>{g.value&&clearInterval(g.value),i.value&&b()}),p(()=>o.isVisible,e=>{e||y()}),{textNote:t,audioUrl:n,photoUrl:l,fileInput:s,isRecording:i,isProcessing:c,recordingDuration:r,hasContent:v,toggleRecording:async()=>{i.value?b():await f()},openCamera:()=>{s.value.setAttribute("capture","environment"),s.value.click()},openGallery:()=>{s.value.removeAttribute("capture"),s.value.click()},handleFileSelect:e=>{const o=e.target.files[0];if(o){const e=new FileReader;e.onload=e=>{l.value=e.target.result},e.readAsDataURL(o)}},removePhoto:()=>{l.value=null,s.value.value=""},formatDuration:e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,saveNote:()=>{const e={coordinates:o.coordinates,textNote:t.value,audioUrl:n.value,photoUrl:l.value,timestamp:(new Date).toISOString()};a("save-note",e),y()}}}},V={key:0,class:"note-panel"},H={class:"note-panel__header"},z={class:"note-panel__content"},B={class:"note-section"},J={class:"note-section"},q={class:"audio-controls"},W=["disabled"],K={key:0,class:"recording-duration"},Q=["src"],X={class:"note-section"},Y={class:"photo-controls"},Z={key:0,class:"photo-preview"},ee=["src"],oe={class:"note-panel__footer"},ae=["disabled"];const te=P(j,[["render",function(e,a,l,r,d,g){var v,p;return l.isVisible?(u(),o("div",V,[t("div",H,[t("h3",null,[a[9]||(a[9]=t("i",{class:"fas fa-sticky-note"},null,-1)),i(" New Note at "+c(null==(v=l.coordinates.lat)?void 0:v.toFixed(6))+", "+c(null==(p=l.coordinates.lng)?void 0:p.toFixed(6)),1)]),t("button",{onClick:a[0]||(a[0]=o=>e.$emit("close")),class:"btn btn--small btn--secondary"},a[10]||(a[10]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",z,[t("div",B,[a[11]||(a[11]=t("label",{class:"note-label"},[t("i",{class:"fas fa-edit"}),i(" Text Note ")],-1)),b(t("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>r.textNote=e),placeholder:"Enter your note here...",class:"note-textarea",rows:"4"},null,512),[[y,r.textNote]])]),t("div",J,[a[12]||(a[12]=t("label",{class:"note-label"},[t("i",{class:"fas fa-microphone"}),i(" Audio Recording ")],-1)),t("div",q,[t("button",{onClick:a[2]||(a[2]=(...e)=>r.toggleRecording&&r.toggleRecording(...e)),class:s(["btn",r.isRecording?"btn--danger":"btn--primary"]),disabled:r.isProcessing},[t("i",{class:s(r.isRecording?"fas fa-stop":"fas fa-microphone")},null,2),i(" "+c(r.isRecording?"Stop Recording":"Start Recording"),1)],10,W),r.recordingDuration>0?(u(),o("span",K,c(r.formatDuration(r.recordingDuration)),1)):n("",!0)]),r.audioUrl?(u(),o("audio",{key:0,src:r.audioUrl,controls:"",class:"audio-player"},null,8,Q)):n("",!0)]),t("div",X,[a[16]||(a[16]=t("label",{class:"note-label"},[t("i",{class:"fas fa-camera"}),i(" Photo ")],-1)),t("div",Y,[t("input",{ref:"fileInput",type:"file",accept:"image/*",capture:"environment",onChange:a[3]||(a[3]=(...e)=>r.handleFileSelect&&r.handleFileSelect(...e)),style:{display:"none"}},null,544),t("button",{onClick:a[4]||(a[4]=(...e)=>r.openCamera&&r.openCamera(...e)),class:"btn btn--primary"},a[13]||(a[13]=[t("i",{class:"fas fa-camera"},null,-1),i(" Take Photo ")])),t("button",{onClick:a[5]||(a[5]=(...e)=>r.openGallery&&r.openGallery(...e)),class:"btn btn--secondary"},a[14]||(a[14]=[t("i",{class:"fas fa-images"},null,-1),i(" From Gallery ")]))]),r.photoUrl?(u(),o("div",Z,[t("img",{src:r.photoUrl,alt:"Note photo",class:"preview-image"},null,8,ee),t("button",{onClick:a[6]||(a[6]=(...e)=>r.removePhoto&&r.removePhoto(...e)),class:"btn btn--small btn--danger remove-photo"},a[15]||(a[15]=[t("i",{class:"fas fa-trash"},null,-1)]))])):n("",!0)])]),t("div",oe,[t("button",{onClick:a[7]||(a[7]=(...e)=>r.saveNote&&r.saveNote(...e)),class:"btn btn--primary",disabled:!r.hasContent||r.isProcessing},a[17]||(a[17]=[t("i",{class:"fas fa-save"},null,-1),i(" Save Note ")]),8,ae),t("button",{onClick:a[8]||(a[8]=o=>e.$emit("close")),class:"btn btn--secondary"}," Cancel ")])])):n("",!0)}],["__scopeId","data-v-be86fcd3"]]),ne={name:"ConfigPanel",props:{isVisible:{type:Boolean,default:!1}},emits:["close","save-config"],setup(e,{emit:o}){const a=C({mediaToTextEndpoint:"",osmTagEndpoint:"",dataStorageEndpoint:"",autoSaveLocal:!0,loadServerNotes:!0,gpsHighAccuracy:!0}),t=()=>{try{const e=localStorage.getItem("osm-notes-config");if(e){const o=JSON.parse(e);Object.assign(a,o)}}catch(e){console.error("Error loading configuration:",e)}};return p(()=>e.isVisible,e=>{e&&t()}),t(),{config:a,saveConfig:()=>{try{localStorage.setItem("osm-notes-config",JSON.stringify(a)),o("save-config",{...a}),o("close")}catch(e){console.error("Error saving configuration:",e),alert("Failed to save configuration")}},exportConfig:()=>{const e=JSON.stringify(a,null,2),o=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(o),n=document.createElement("a");n.href=t,n.download="osm-notes-config.json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)},resetConfig:()=>{confirm("Are you sure you want to reset all settings to defaults?")&&(a.mediaToTextEndpoint="",a.osmTagEndpoint="",a.dataStorageEndpoint="",a.autoSaveLocal=!0,a.loadServerNotes=!0,a.gpsHighAccuracy=!0)}}}},le={key:0,class:"config-panel"},se={class:"config-panel__header"},ie={class:"config-panel__content"},ce={class:"config-section"},re={class:"config-field"},ue={class:"config-field"},de={class:"config-field"},ge={class:"config-section"},ve={class:"config-field"},pe={class:"toggle-switch"},fe={class:"config-field"},me={class:"toggle-switch"},he={class:"config-field"},be={class:"toggle-switch"},ye={class:"config-section"},Ce={class:"config-field"},Se={class:"config-field"},_e={class:"config-panel__footer"};const Ee=P(ne,[["render",function(e,a,l,s,c,r){return l.isVisible?(u(),o("div",le,[t("div",se,[a[12]||(a[12]=t("h3",null,[t("i",{class:"fas fa-cog"}),i(" Configuration ")],-1)),t("button",{onClick:a[0]||(a[0]=o=>e.$emit("close")),class:"btn btn--small btn--secondary"},a[11]||(a[11]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",ie,[t("div",ce,[a[16]||(a[16]=t("h4",{class:"section-title"},[t("i",{class:"fas fa-link"}),i(" External API Endpoints ")],-1)),t("div",re,[a[13]||(a[13]=t("label",{class:"config-label"},[i(" Media-to-Text API (Endpoint #1) "),t("span",{class:"label-description"},"Converts audio/images + coordinates to text transcription")],-1)),b(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.config.mediaToTextEndpoint=e),type:"url",placeholder:"https://api.example.com/media-to-text",class:"config-input"},null,512),[[y,s.config.mediaToTextEndpoint]])]),t("div",ue,[a[14]||(a[14]=t("label",{class:"config-label"},[i(" OSM Tag Generation API (Endpoint #2) "),t("span",{class:"label-description"},"Processes notes + coordinates to generate OSM tags")],-1)),b(t("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.config.osmTagEndpoint=e),type:"url",placeholder:"https://api.example.com/osm-tags",class:"config-input"},null,512),[[y,s.config.osmTagEndpoint]])]),t("div",de,[a[15]||(a[15]=t("label",{class:"config-label"},[i(" Data Storage API (Endpoint #3) "),t("span",{class:"label-description"},"Bidirectional storage (GET/POST) for coordinate data with notes and tags")],-1)),b(t("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>s.config.dataStorageEndpoint=e),type:"url",placeholder:"https://api.example.com/data-storage",class:"config-input"},null,512),[[y,s.config.dataStorageEndpoint]])])]),t("div",ge,[a[23]||(a[23]=t("h4",{class:"section-title"},[t("i",{class:"fas fa-sliders-h"}),i(" Application Settings ")],-1)),t("div",ve,[a[18]||(a[18]=t("label",{class:"config-label"}," Auto-save notes locally ",-1)),t("div",pe,[b(t("input",{type:"checkbox",id:"autoSave","onUpdate:modelValue":a[4]||(a[4]=e=>s.config.autoSaveLocal=e),class:"toggle-input"},null,512),[[S,s.config.autoSaveLocal]]),a[17]||(a[17]=t("label",{for:"autoSave",class:"toggle-label"},null,-1))])]),t("div",fe,[a[20]||(a[20]=t("label",{class:"config-label"}," Load server notes in viewport ",-1)),t("div",me,[b(t("input",{type:"checkbox",id:"loadServerNotes","onUpdate:modelValue":a[5]||(a[5]=e=>s.config.loadServerNotes=e),class:"toggle-input"},null,512),[[S,s.config.loadServerNotes]]),a[19]||(a[19]=t("label",{for:"loadServerNotes",class:"toggle-label"},null,-1))])]),t("div",he,[a[22]||(a[22]=t("label",{class:"config-label"}," GPS high accuracy mode ",-1)),t("div",be,[b(t("input",{type:"checkbox",id:"highAccuracy","onUpdate:modelValue":a[6]||(a[6]=e=>s.config.gpsHighAccuracy=e),class:"toggle-input"},null,512),[[S,s.config.gpsHighAccuracy]]),a[21]||(a[21]=t("label",{for:"highAccuracy",class:"toggle-label"},null,-1))])])]),t("div",ye,[a[26]||(a[26]=t("h4",{class:"section-title"},[t("i",{class:"fas fa-bug"}),i(" Debug Tools ")],-1)),t("div",Ce,[t("button",{onClick:a[7]||(a[7]=(...e)=>s.exportConfig&&s.exportConfig(...e)),class:"btn btn--secondary btn--full-width"},a[24]||(a[24]=[t("i",{class:"fas fa-download"},null,-1),i(" Export Configuration ")]))]),t("div",Se,[t("button",{onClick:a[8]||(a[8]=(...e)=>s.resetConfig&&s.resetConfig(...e)),class:"btn btn--danger btn--full-width"},a[25]||(a[25]=[t("i",{class:"fas fa-undo"},null,-1),i(" Reset to Defaults ")]))])])]),t("div",_e,[t("button",{onClick:a[9]||(a[9]=(...e)=>s.saveConfig&&s.saveConfig(...e)),class:"btn btn--primary"},a[27]||(a[27]=[t("i",{class:"fas fa-save"},null,-1),i(" Save Configuration ")])),t("button",{onClick:a[10]||(a[10]=o=>e.$emit("close")),class:"btn btn--secondary"}," Cancel ")])])):n("",!0)}],["__scopeId","data-v-7d6aeb94"]]);const ke=e([]),we=e([]);const Pe={class:"app"},Le={class:"header"},xe={class:"header__controls"},Ne=["disabled"],Ae={class:"main"},Ie={class:"map-section"};const Te=E(P({name:"App",components:{MapContainer:A,Crosshair:T,EventLogger:R,NotePanel:te,ConfigPanel:Ee},setup(){const o=e(!1),a=e(!1),t=e(!1),n=e({lat:null,lng:null,accuracy:null}),l=e({mediaToTextEndpoint:"",osmTagEndpoint:"",dataStorageEndpoint:"",autoSaveLocal:!0,loadServerNotes:!0,gpsHighAccuracy:!0}),{events:s,logEvent:i}=function(){const o=e([]),a=(e,a,t={})=>{const n={id:Date.now()+Math.random().toString(36).substr(2,9),type:e,message:a,timestamp:Date.now(),...t};o.value.push(n),o.value.length>100&&(o.value=o.value.slice(-100)),console.log(`[${e.toUpperCase()}] ${a}`,t)};return{events:o,logEvent:a,clearEvents:()=>{o.value=[],a("system","Event log cleared")},getEventsByType:e=>o.value.filter(o=>o.type===e),getEventsInTimeRange:(e,a)=>o.value.filter(o=>o.timestamp>=e&&o.timestamp<=a),exportEvents:()=>{const e={exportDate:(new Date).toISOString(),totalEvents:o.value.length,events:o.value};return JSON.stringify(e,null,2)}}}(),{localNotes:c,serverNotes:r,saveLocalNote:u}=function(){const e=()=>{try{const e=localStorage.getItem("osm-notes-local");e&&(ke.value=JSON.parse(e))}catch(e){console.error("Error loading notes from localStorage:",e)}},o=()=>{try{localStorage.setItem("osm-notes-local",JSON.stringify(ke.value))}catch(e){console.error("Error saving notes to localStorage:",e)}},a=()=>"note_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);return e(),{localNotes:ke,serverNotes:we,saveLocalNote:e=>{const t={id:a(),...e,type:"local",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return ke.value.push(t),o(),t},deleteLocalNote:e=>{const a=ke.value.findIndex(o=>o.id===e);-1!==a&&(ke.value.splice(a,1),o())},updateLocalNote:(e,a)=>{const t=ke.value.find(o=>o.id===e);t&&(Object.assign(t,a,{updatedAt:(new Date).toISOString()}),o())},getNotesInBounds:e=>[...ke.value,...we.value].filter(o=>{const a=o.coordinates.lat,t=o.coordinates.lng;return a>=e.south&&a<=e.north&&t>=e.west&&t<=e.east}),loadFromLocalStorage:e,saveToLocalStorage:o}}(),d=m(()=>[...c.value,...r.value]);return _(()=>{i("system","Application initialized with note-taking capabilities")}),{showEventLogger:o,showNotePanel:a,showConfigPanel:t,currentCoordinates:n,allNotes:d,appConfig:l,events:s,toggleEventLogger:()=>{o.value=!o.value,i("ui","Event logger "+(o.value?"opened":"closed"))},openNotePanel:()=>{n.value.lat&&(a.value=!0,i("ui",`Note panel opened for coordinates ${n.value.lat.toFixed(6)}, ${n.value.lng.toFixed(6)}`))},openConfigPanel:()=>{t.value=!0,i("ui","Configuration panel opened")},handleCoordinatesChanged:e=>{n.value=e,i("coordinates",`Crosshair positioned at ${e.lat.toFixed(6)}, ${e.lng.toFixed(6)}`)},handleLocationFound:e=>{i("gps",`GPS location found: ${e.lat.toFixed(6)}, ${e.lng.toFixed(6)} (accuracy: ${e.accuracy}m)`)},handleLocationError:e=>{i("error",`GPS error: ${e.message}`)},handleSaveNote:e=>{const o=u(e);a.value=!1,i("note",`Local note saved with ID: ${o.id}`)},handlePinClick:e=>{i("ui",`Clicked on ${e.type} note pin: ${e.id}`)},handleSaveConfig:e=>{l.value={...e},i("config","Configuration saved with API endpoints updated")},logEvent:i}}},[["render",function(e,l,s,c,g,v){const p=r("MapContainer"),f=r("Crosshair"),m=r("NotePanel"),h=r("ConfigPanel"),b=r("EventLogger");return u(),o("div",Pe,[t("header",Le,[l[8]||(l[8]=t("h1",{class:"header__title"},[t("i",{class:"fas fa-crosshairs"}),i(" OSM Notes v0.1.4 ")],-1)),t("div",xe,[t("button",{onClick:l[0]||(l[0]=(...e)=>c.openNotePanel&&c.openNotePanel(...e)),class:"btn btn--primary",title:"Add note at current coordinates",disabled:!c.currentCoordinates.lat},l[5]||(l[5]=[t("i",{class:"fas fa-sticky-note"},null,-1),t("span",{class:"btn__text"},"Add Note",-1)]),8,Ne),t("button",{onClick:l[1]||(l[1]=(...e)=>c.toggleEventLogger&&c.toggleEventLogger(...e)),class:"btn btn--secondary",title:"Show event log"},l[6]||(l[6]=[t("i",{class:"fas fa-list"},null,-1),t("span",{class:"btn__text"},"Event Log",-1)])),t("button",{onClick:l[2]||(l[2]=(...e)=>c.openConfigPanel&&c.openConfigPanel(...e)),class:"btn btn--secondary",title:"Open configuration"},l[7]||(l[7]=[t("i",{class:"fas fa-cog"},null,-1),t("span",{class:"btn__text"},"Config",-1)]))])]),t("main",Ae,[t("div",Ie,[a(p,{notes:c.allNotes,onCoordinatesChanged:c.handleCoordinatesChanged,onLocationFound:c.handleLocationFound,onLocationError:c.handleLocationError,onMapEvent:c.logEvent,onPinClicked:c.handlePinClick},null,8,["notes","onCoordinatesChanged","onLocationFound","onLocationError","onMapEvent","onPinClicked"]),a(f)]),a(m,{"is-visible":c.showNotePanel,coordinates:c.currentCoordinates,onClose:l[3]||(l[3]=e=>c.showNotePanel=!1),onSaveNote:c.handleSaveNote},null,8,["is-visible","coordinates","onSaveNote"]),a(h,{"is-visible":c.showConfigPanel,onClose:l[4]||(l[4]=e=>c.showConfigPanel=!1),onSaveConfig:c.handleSaveConfig},null,8,["is-visible","onSaveConfig"]),c.showEventLogger?(u(),d(b,{key:0,events:c.events},null,8,["events"])):n("",!0)])])}]]));Te.use(w),Te.mount("#app");
